妊婦向け栄養管理アプリMVP 要件定義書（完成版）
はじめに
LLM活用の根拠（sauce）と免責事項の提示
	1. 当アプリでは、食事記録や栄養素推定、献立レコメンドに一部LLM（大規模言語モデル）による回答や推定ロジックを採用しており、 
		○ LLMからの回答や計算結果は常に正確とは限りません。
		○ 医療的判断や処方に代わるものではなく、参考情報としてご利用ください。
	2. 妊娠中の健康管理や医療上の重要な事項については、必ずかかりつけの医師や専門家にご相談ください。
	3. 本アプリは、妊婦の「簡易的な栄養管理と献立作成支援」を目的としており、医療行為や健康診断の代替にはなりません。
ユーザー同意ボタンの追加
	• アプリ起動・初回登録時に、上記免責事項を表示したうえで「同意する」ボタンを設置。
	• ユーザーが同意しない場合は、アプリの主要機能（食事記録や献立提案）を利用できない仕様とする（利用規約の一部として扱う）。

1. 対象ユーザー／ペルソナ
	• 主なユーザー: 妊娠中の女性（子育てと仕事を両立する多忙な層）
	• ニーズ: 
		○ 栄養管理（カロリー、タンパク質、鉄分、葉酸などの適正摂取）
		○ 時間短縮（1回の入力が1〜2分で完了するUI）
		○ 夕食献立のアイデア提供
		○ 将来的な家族全体の食事管理への拡張可能性

2. 主要機能（MVP）
2-1. ユーザープロファイル設定
	• 機能ID: F-001
	• 機能名: ユーザープロファイル登録・編集
	• 説明:
ユーザーの基本情報（年齢、性別、妊娠週数または出産予定日、身長、体重、目標体重または体重増加目安）を登録・編集し、
そこからLLMの計算ロジックを用いて「1日の推奨カロリー・栄養素目安（タンパク質、脂質、炭水化物、鉄分、葉酸など）」を自動算出する。
	• 必須項目:
		○ 年齢
		○ 性別（女性固定を想定）
		○ 妊娠週数（または出産予定日）
		○ 身長
		○ 体重
	• 入力形式:
		○ 年齢: 数値入力またはプルダウン
		○ 妊娠週数: 数値入力またはカレンダー入力
		○ 身長: 数値入力（cm）
		○ 体重: 数値入力（kg）
	• 出力:
		○ 1日の推奨カロリー・栄養素目安を算出し、ダッシュボードで可視化。
		○ 計算ロジックはLangChain.jsを活用してバックエンドで行い、結果を返す。
	• 備考:
		○ 本機能で登録された情報は、食事記録の自動計算・栄養バランスの評価・献立提案に利用。
		○ 将来的には家族構成（子どもの年齢など）入力も追加し、家族分の献立管理機能へ拡張可能。
2-2. 食事記録（ログ機能）
	• 入力方法:
		○ マルチモーダル入力 
			1. アプリ内カメラによる写真撮影
			2. 端末の写真アプリからの画像選択
			3. テキスト入力（食材・メニュー名の直接入力）
	• 必須項目:
		○ 食材/メニュー名
		○ 摂取量
		○ 時間帯（朝・昼・夜・間食など）
	• 自動機能:
		○ 画像解析（写真からの自動推定）
		○ LLMによるカロリー・栄養素計算ロジック
		○ 誤差修正可能なUI：ユーザーが補正や編集を行いやすいフォームを用意。
	• 備考:
		○ MVPの段階では、推定精度の目安を設定（例: 80%程度の精度を想定）。
		○ 実際に撮影・推定した食事記録は、ダッシュボードの摂取状況に即時反映される。
2-3. 簡易ダッシュボード（栄養バランス確認）
	• 表示内容:
		○ 1日の総摂取カロリー、主要栄養素の達成率（例: タンパク質、脂質、炭水化物、鉄分、葉酸など）
		○ 円グラフまたはバーグラフで可視化
	• アラート:
		○ 不足・過剰な項目を色分け表示で注意喚起
		○ LLMによるワンポイントアドバイス（例: 「鉄分を増やすためにレバーやほうれん草を取り入れてみましょう」など）
	• 備考:
		○ シンプルなUIを優先し、1画面で1日の状況が確認できる設計。
		○ 週単位・月単位のグラフ切替はMVP後に拡張可能。
2-4. 献立提案（レコメンド機能）
	• レシピ提案:
		○ 当日または翌日の夕食向けに、3〜5件の簡単・時短レシピを表示
		○ 妊娠中の注意食材（生肉やアルコールなど）を自動フィルタ可能
	• アルゴリズム:
		○ 食事記録からの不足栄養素やユーザー嗜好タグ（辛いもの苦手、和食好きなど）を参照
		○ LangChain.jsとGemini APIを活用し、最適なレシピ候補を生成
		○ 調理時間、難易度、栄養素情報なども表示
	• 備考:
		○ レシピ詳細画面には調理ステップや必要食材を明示。
		○ 利用者の手間を軽減するために、調理時間は30分以内を優先して提案。
2-5. リマインド・通知機能
	• 機能:
		○ 食事記録の入力忘れ防止プッシュ通知（朝・昼・夜など、任意の時間設定）
		○ 妊娠週数に応じた栄養アドバイス定期配信
		○ 「妊娠○週: そろそろ体重管理に注意しましょう」といったメッセージを表示
	• 備考:
		○ 通知頻度や時間をユーザーが調整可能にする。
		○ 将来的には、産後の離乳食・子どもの栄養管理を通知する機能にも拡張可能。

3. システムアーキテクチャと技術スタック
3-1. フロントエンド
	• フレームワーク: Next.js
		○ Next.js App Routerを利用し、APIルートとフロントエンドを統合
		○ PWA（プログレッシブウェブアプリ）として設計し、スマホでもアプリ感覚で利用可能にする。
	• UI/UX:
		○ モバイルファーストデザイン、シンプルで直感的なインターフェース。
		○ 必要な操作（食事記録、献立レコメンドなど）を1〜2タップで完結できる構成。
3-2. バックエンド
	• AI連携:
		○ LangChain.jsをAIエンジンとして利用し、Next.js API Routesで実装
		○ Gemini 2.0 Flashを画像解析に活用し、高精度な食品検出を実現
		○ 構造化出力パーサーを使用して、一貫性のある応答フォーマットを確保
	• API統合:
		○ フロントエンド（Next.js）からは、内部APIを呼び出し、解析結果を即時取得。
		○ ユーザーのリクエストが増加した際のスケーラビリティも念頭に置く。
3-3. データベース
	• DB選定: Supabase（PostgreSQLベース） 
		○ ユーザープロファイル、食事ログ、レシピ情報、通知設定などを安全に管理。
		○ リアルタイム更新機能を活用し、ダッシュボードに即時反映。
		○ 将来的に家族情報や子どものプロフィールを追加する際にも柔軟に拡張可能。

4. ユーザーストーリー（MVP想定）
	1. ユーザー同意画面
		○ アプリを初回起動 → 「LLM活用の回答は常に正確ではない」「医師への相談が必要」「本アプリは妊婦の簡易栄養管理ツール」など免責事項を表示 → 「同意する」ボタンを押すとメイン画面へ遷移。
	2. アカウント作成
		○ メールアドレス／パスワードの登録 → ユーザープロファイル（年齢、妊娠週数、身長、体重）を入力 → 推奨カロリー・栄養素目安を自動算出 → ダッシュボードに反映。
	3. 食事記録の入力
		○ 「食事を記録する」ボタンをタップ → 食事タイプ（朝食/昼食/夕食/間食）を選択 → 写真を撮影または選択 → AI解析で食材・メニューを自動検出 → 検出結果を確認・編集 → 保存。
	4. 栄養バランスの確認
		○ ホーム画面またはダッシュボード画面で、その日の栄養摂取状況を確認 → 不足している栄養素（例: 鉄分）を確認 → AIアドバイスを参考に次の食事計画を立てる。
	5. 献立提案の利用
		○ 「献立を提案する」ボタンをタップ → 何人分の献立かを選択 → 除外したい食材があれば入力 → 「提案する」ボタンをタップ → 不足栄養素を補うレシピ候補が表示される → 気に入ったレシピを選択して詳細を確認。

## 5. 画面遷移図

### ランディングページ（/）
**目的**: アプリ紹介と認証への入口  
**UI要素**:
- アプリロゴとキャッチコピー
- 「新規登録」ボタン
- 「ログイン」ボタン  
**遷移先**: /login（ログイン）、/register（新規登録）

### ログイン画面（/login）
**目的**: 既存ユーザーの認証  
**UI要素**:
- メールアドレス入力フィールド
- パスワード入力フィールド
- 「ログイン」ボタン
- 「パスワードを忘れた」リンク  
**遷移先**: 認証成功後に /home

### 新規登録画面（/register）
**目的**: 新規ユーザーの登録  
**UI要素**:
- メールアドレス入力フィールド
- パスワード入力フィールド
- 「登録」ボタン  
**遷移先**: 登録成功後に /profile

### プロフィール設定画面（/profile）
**目的**: ユーザープロフィールの設定  
**UI要素**:
- 年齢入力フィールド
- 妊娠週数入力フィールド
- 身長入力フィールド
- 体重入力フィールド
- 家族構成入力フィールド
- 「保存」ボタン  
**遷移先**: 保存後に /home

### ホーム画面（/home）
**目的**: 主要機能へのアクセスとステータス概要の表示  
**UI要素**:
- ウェルカムセクション（妊娠週数表示）
- クイックアクションボタン
- 「食事を記録する」ボタン
- 「献立を提案する」ボタン
- 今日の栄養状態サマリー（シンプルなグラフ）
- ナビゲーションメニュー  
**遷移先**: /meals/record（食事記録）、/recipes（献立提案）、/dashboard（詳細ダッシュボード）

### 食事記録画面（/meals/record）
**目的**: 食事の記録と栄養価の確認  
**UI要素**:
- 食事タイプ選択（朝食/昼食/夕食/間食）
- 写真撮影/選択ボタン
- 写真プレビュー領域
- AI解析結果表示領域（認識された食事内容）
- 認識結果の編集オプション
- 追加入力フォーム（飲み物、サプリメントなど）
- 人数入力フィールド
- 「保存」ボタン  
**遷移先**: 保存後に /home または /dashboard

### 食事記録詳細画面（/meals/:id）
**目的**: 記録した食事の詳細表示と編集  
**UI要素**:
- 食事写真
- 食事内容リスト
- 栄養価サマリー
- 「編集」ボタン
- 「削除」ボタン  
**遷移先**: 編集時に /meals/record、削除後に /home

### 栄養ダッシュボード画面（/dashboard）
**目的**: 詳細な栄養状態の確認  
**UI要素**:
- 日付選択カレンダー
- カロリー摂取円グラフ
- 主要栄養素バーグラフ（たんぱく質、鉄分、葉酸、カルシウム）
- 栄養バランスのアドバイステキスト
- 食事記録リスト（その日の食事一覧）  
**遷移先**: 食事記録選択時に /meals/:id

### 献立提案画面（/recipes）
**目的**: 栄養バランスを考慮したレシピの提案  
**UI要素**:
- 人数選択フィールド
- 除外したい食材入力フィールド
- 「提案を表示」ボタン
- レシピカードリスト（3-5件の提案）
- レシピ名
- 栄養価サマリー
- 「詳細を見る」リンク  
**遷移先**: レシピ選択時に /recipes/:id

### レシピ詳細画面（/recipes/:id）
**目的**: 提案されたレシピの詳細表示  
**UI要素**:
- レシピ名と説明
- 材料リスト（人数に応じた分量調整可能）
- 調理手順
- 栄養価詳細
- 「レシピをシェア」ボタン
- 「食事として記録」ボタン  
**遷移先**: 記録選択時に /meals/record（レシピ情報を引き継ぎ）

### 設定画面（/settings）
**目的**: ユーザープロフィールと設定の管理  
**UI要素**:
- プロフィール編集セクション
- 通知設定
- ログアウトボタン  
**遷移先**: プロフィール編集時に /profile、ログアウト後に /

### モバイル対応のためのUI考慮点
- レスポンシブデザイン
  - すべての画面はモバイルファーストで設計
  - グリッドレイアウトの活用
  - フォントサイズと要素間の余白の最適化
- タッチフレンドリーなUI
  - タップしやすいボタンサイズ（最低44px × 44px）
  - スワイプジェスチャーの活用（例：食事記録リストのスワイプで編集/削除）
  - モバイルでのフォーム入力の最適化（大きな入力フィールド、適切なキーボードタイプ）
- PWA対応
  - アプリのインストール促進
  - オフライン時の基本機能維持
  - プッシュ通知対応

### 全体のナビゲーション構造
- ボトムナビゲーションバー（モバイル）
  - ホーム
  - 食事記録
  - 献立提案
  - ダッシュボード
  - 設定
- サイドナビゲーション（タブレット・デスクトップ）
  - 同上の項目をサイドバーに配置

### 状態管理とデータフロー
- ユーザー認証状態
  - ログイン状態の管理
  - 認証情報の永続化
- プロフィールデータ
  - ユーザー基本情報
  - 家族構成
  - 推奨栄養量
- 食事記録データ
  - 日付別の食事記録
  - 写真とAI解析結果
  - 手動で追加した情報
- 栄養状態データ
  - 日次の栄養摂取状況
  - 推奨値との比較
- 献立提案データ
  - 提案されたレシピ
  - カスタマイズ情報（人数、除外食材）

8. まとめ・今後の展開
	• 本要件定義書は、妊娠中の多忙な女性向けに「簡易な栄養管理と献立作成を支援するMVP」を構築するための指針を示します。
	• LLMの回答と画像解析を組み合わせることで、従来の手動入力に比べスムーズな記録体験を提供し、栄養不足を補いやすくする工夫を取り入れています。
	• しかしながら、あくまでも「医療的アドバイス」や「健康診断」の代替ではなく、補助的なツールであることを明確にし、ユーザーにもその旨を同意画面でしっかり理解してもらう必要があります。
	• MVP段階で収集したユーザーフィードバックを踏まえ、精度向上や家族構成管理、離乳食期への拡張などを進めることで、長期的な利用価値を高めることが可能です。
	• 産後も使えるアプリとしての発展
	• 週単位、月単位で可視化のダッシュボード設計など
